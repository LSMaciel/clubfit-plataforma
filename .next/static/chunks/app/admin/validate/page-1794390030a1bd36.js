(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[133],{1593:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var r=t(5155),a=t(2115),l=t(8500),d=t.n(l),n=t(1935);function c({onScanSuccess:e}){let[s,t]=(0,a.useState)(null),l=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!l.current){let s=new n.TF("reader",{fps:10,qrbox:{width:250,height:250},formatsToSupport:[n.Jl.QR_CODE],rememberLastUsedCamera:!0},!1);s.render(t=>{s.clear().catch(console.error),e(t)},e=>{}),l.current=s}return()=>{l.current&&l.current.clear().catch(console.error)}},[e]),(0,r.jsxs)("div",{className:"w-full max-w-sm mx-auto",children:[(0,r.jsx)("div",{id:"reader",className:"overflow-hidden rounded-xl border-2 border-slate-200"}),(0,r.jsx)("p",{className:"text-center text-xs text-slate-500 mt-2",children:"Aponte a c\xe2mera para o QR Code do aluno"})]})}var o=t(9339);let i=(0,o.createServerReference)("401e0cc06b15269d78fcc688b40f6715eff9bbd9e2",o.callServer,void 0,o.findSourceMapURL,"validateTokenAction");function x(){let[e,s]=(0,a.useState)("SCAN"),[t,l]=(0,a.useState)(!1),[n,o]=(0,a.useState)(null);async function x(e){if(!e)return;l(!0),o(null);let s=e.trim();o(await i(s)),l(!1)}return(0,r.jsxs)("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[(0,r.jsx)("nav",{className:"bg-white border-b border-slate-200 px-8 py-4",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto flex items-center gap-4",children:[(0,r.jsx)(d(),{href:"/admin/dashboard",className:"text-sm text-slate-500 hover:text-slate-900",children:"← Voltar"}),(0,r.jsx)("h1",{className:"font-bold text-xl text-slate-900",children:"Validar Voucher"})]})}),(0,r.jsx)("main",{className:"flex-1 p-4 md:p-8",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[n&&(0,r.jsxs)("div",{className:`mb-6 p-6 rounded-2xl shadow-lg border-2 text-center animate-in zoom-in-95 duration-200 ${n.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[(0,r.jsx)("div",{className:"text-4xl mb-2",children:n.success?"✅":"❌"}),(0,r.jsx)("h2",{className:`text-xl font-bold mb-1 ${n.success?"text-green-800":"text-red-800"}`,children:n.success?"Validado com Sucesso!":"Falha na Valida\xe7\xe3o"}),(0,r.jsx)("p",{className:`text-sm mb-4 ${n.success?"text-green-700":"text-red-700"}`,children:n.message}),n.success&&(0,r.jsxs)("div",{className:"bg-white/60 rounded-lg p-3 text-left space-y-2 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-green-700 font-bold uppercase",children:"Aluno"}),(0,r.jsx)("p",{className:"text-green-900 font-medium",children:n.student})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-green-700 font-bold uppercase",children:"Benef\xedcio Aplicado"}),(0,r.jsx)("p",{className:"text-green-900 font-medium",children:n.benefit})]})]}),(0,r.jsx)("button",{onClick:function(){o(null),l(!1)},className:`w-full py-3 rounded-xl font-bold text-white shadow-md ${n.success?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:n.success?"Validar Pr\xf3ximo":"Tentar Novamente"})]}),!n&&(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex border-b border-slate-100",children:[(0,r.jsx)("button",{onClick:()=>s("SCAN"),className:`flex-1 py-4 text-sm font-medium text-center ${"SCAN"===e?"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50/50":"text-slate-500 hover:text-slate-800"}`,children:"\uD83D\uDCF7 C\xe2mera"}),(0,r.jsx)("button",{onClick:()=>s("MANUAL"),className:`flex-1 py-4 text-sm font-medium text-center ${"MANUAL"===e?"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50/50":"text-slate-500 hover:text-slate-800"}`,children:"⌨️ Digitar C\xf3digo"})]}),(0,r.jsxs)("div",{className:"p-6",children:["SCAN"===e&&(0,r.jsx)(c,{onScanSuccess:x}),"MANUAL"===e&&(0,r.jsxs)("form",{action:e=>x(e.get("code")),className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2 text-center",children:"C\xf3digo do Voucher (8 caracteres ou completo)"}),(0,r.jsx)("input",{name:"code",type:"text",placeholder:"Ex: 8f9a2...",className:"block w-full text-center text-2xl font-mono tracking-widest rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-4 border uppercase",autoFocus:!0,required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:t,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 disabled:opacity-50",children:t?"Verificando...":"Validar C\xf3digo"})]})]})]}),!n&&"SCAN"===e&&(0,r.jsx)("p",{className:"text-center mt-6 text-xs text-slate-400",children:"Certifique-se que o ambiente est\xe1 bem iluminado."})]})})]})}},2984:(e,s,t)=>{Promise.resolve().then(t.bind(t,1593))}},e=>{e.O(0,[604,500,261,441,928,358],()=>e(e.s=2984)),_N_E=e.O()}]);