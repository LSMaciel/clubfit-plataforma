(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[153],{536:(e,t,s)=>{Promise.resolve().then(s.bind(s,4538))},4538:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var l=s(5155),a=s(2115),r=s(9549),n=s(9339);let i=(0,n.createServerReference)("0051bcb4dd61a86142067857e928af31f327a1f15e",n.callServer,void 0,n.findSourceMapURL,"generateWalletToken");var o=s(8500),c=s.n(o);function d(){let e,[t,s]=(0,a.useState)(null),[n,o]=(0,a.useState)(null),[d,x]=(0,a.useState)(0),[m,f]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null);async function b(){f(!0),h(null),s(null);try{let e=await i();if(e.error)h(e.error);else{s(e.token);let t=new Date(e.expiresAt);o(t);let l=Math.floor((t.getTime()-Date.now())/1e3);x(Math.max(0,l))}}catch(e){h("Erro de conex\xe3o.")}finally{f(!1)}}(0,a.useEffect)(()=>{b()},[]),(0,a.useEffect)(()=>{if(!n||d<=0)return;let e=setInterval(()=>{x(Math.max(0,Math.floor((n.getTime()-Date.now())/1e3)))},1e3);return()=>clearInterval(e)},[n,d]);let p=d<=0&&!m;return(0,l.jsxs)("div",{className:"min-h-screen bg-slate-50 flex flex-col items-center pt-8 px-4",children:[(0,l.jsxs)("div",{className:"w-full max-w-md mb-8 flex items-center",children:[(0,l.jsx)(c(),{href:"/student/dashboard",className:"text-[var(--primary-color)] flex items-center gap-2 font-medium",children:"â† Voltar"}),(0,l.jsx)("h1",{className:"flex-1 text-center font-bold text-slate-800 text-lg mr-8",children:"Carteira Digital"})]}),(0,l.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-100 flex flex-col items-center p-8 relative",children:[(0,l.jsxs)("div",{className:"w-full flex justify-between items-center mb-6",children:[(0,l.jsx)("span",{className:"text-sm text-slate-400 font-medium",children:"Token de Acesso"}),m?(0,l.jsx)("span",{className:"text-xs text-slate-400 animate-pulse",children:"Gerando..."}):(0,l.jsx)("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full ${p?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:p?"EXPIRADO":"V\xc1LIDO"})]}),(0,l.jsxs)("div",{className:"relative w-64 h-64 bg-slate-50 rounded-2xl flex items-center justify-center p-4 border border-slate-100",children:[m&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 z-10",children:(0,l.jsx)("div",{className:"w-8 h-8 border-4 border-[var(--primary-color)] border-t-transparent rounded-full animate-spin"})}),u&&(0,l.jsxs)("div",{className:"text-center text-red-500 text-sm px-4",children:[(0,l.jsx)("p",{className:"font-bold mb-2",children:"Erro"}),u,(0,l.jsx)("button",{onClick:b,className:"mt-4 text-xs underline",children:"Tentar novamente"})]}),!m&&!u&&t&&!p&&(0,l.jsx)(r.Ay,{value:t,size:220,viewBox:"0 0 256 256",fgColor:"#1e293b"}),p&&!m&&(0,l.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/95 z-20 text-center",children:[(0,l.jsx)("p",{className:"text-slate-400 font-bold mb-2",children:"Token Expirado"}),(0,l.jsx)("button",{onClick:b,className:"px-6 py-2 bg-[var(--primary-color)] text-white rounded-full font-bold shadow-lg active:scale-95 transition-all",children:"Gerar Novo"})]})]}),(0,l.jsxs)("div",{className:"mt-8 text-center",children:[(0,l.jsx)("p",{className:"text-slate-400 text-sm mb-1",children:"Este c\xf3digo expira em"}),(0,l.jsx)("p",{className:`text-3xl font-mono font-bold ${d<10?"text-red-500":"text-slate-800"}`,children:(e=Math.floor(d/60),`${e}:${(d%60).toString().padStart(2,"0")}`)})]})]}),(0,l.jsx)("p",{className:"mt-8 text-center text-slate-400 text-sm max-w-xs mx-auto",children:"Apresente este QR Code ao parceiro para validar seu benef\xedcio ou entrada."})]})}}},e=>{e.O(0,[500,927,441,928,358],()=>e(e.s=536)),_N_E=e.O()}]);