{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carolina/Desktop/00%20-%20Clubfit/utils/auth-student.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose'\r\nimport { cookies } from 'next/headers'\r\n\r\nconst SECRET_KEY = process.env.SUPABASE_JWT_SECRET || 'fallback-secret-key-change-me'\r\nconst key = new TextEncoder().encode(SECRET_KEY)\r\n\r\nexport async function encryptStudentSession(payload: any) {\r\n    return await new SignJWT(payload)\r\n        .setProtectedHeader({ alg: 'HS256' })\r\n        .setIssuedAt()\r\n        .setExpirationTime('30d') // Longa duração para \"App\" feel\r\n        .sign(key)\r\n}\r\n\r\nexport async function decryptStudentSession(input: string): Promise<any> {\r\n    try {\r\n        const { payload } = await jwtVerify(input, key, {\r\n            algorithms: ['HS256'],\r\n        })\r\n        return payload\r\n    } catch (error) {\r\n        return null\r\n    }\r\n}\r\n\r\nexport async function getStudentSession() {\r\n    const cookieStore = await cookies()\r\n    const token = cookieStore.get('clubfit-student-token')?.value\r\n    if (!token) return null\r\n    return await decryptStudentSession(token)\r\n}\r\n\r\nexport async function createStudentSession(studentId: string, academyId: string) {\r\n    const expires = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 dias\r\n    const session = await encryptStudentSession({ studentId, academyId, expires })\r\n\r\n    const cookieStore = await cookies()\r\n    cookieStore.set('clubfit-student-token', session, {\r\n        httpOnly: true,\r\n        secure: process.env.NODE_ENV === 'production',\r\n        expires,\r\n        sameSite: 'lax',\r\n        path: '/',\r\n    })\r\n}\r\n\r\nexport async function deleteStudentSession() {\r\n    const cookieStore = await cookies()\r\n    cookieStore.delete('clubfit-student-token')\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AACtD,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,sBAAsB,OAAY;IACpD,OAAO,MAAM,IAAI,gMAAO,CAAC,SACpB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAAO,gCAAgC;KACzD,IAAI,CAAC;AACd;AAEO,eAAe,sBAAsB,KAAa;IACrD,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,oMAAS,EAAC,OAAO,KAAK;YAC5C,YAAY;gBAAC;aAAQ;QACzB;QACA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,0KAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,0BAA0B;IACxD,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,MAAM,sBAAsB;AACvC;AAEO,eAAe,qBAAqB,SAAiB,EAAE,SAAiB;IAC3E,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,UAAU;;IAC1E,MAAM,UAAU,MAAM,sBAAsB;QAAE;QAAW;QAAW;IAAQ;IAE5E,MAAM,cAAc,MAAM,IAAA,0KAAO;IACjC,YAAY,GAAG,CAAC,yBAAyB,SAAS;QAC9C,UAAU;QACV,QAAQ,oDAAyB;QACjC;QACA,UAAU;QACV,MAAM;IACV;AACJ;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,0KAAO;IACjC,YAAY,MAAM,CAAC;AACvB"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carolina/Desktop/00%20-%20Clubfit/utils/supabase/admin.ts"],"sourcesContent":["\nimport { createClient } from '@supabase/supabase-js'\n\n// Nota: Este cliente deve ser usado APENAS no servidor (Server Actions/API Routes)\n// Ele usa a Service Role Key para ignorar RLS e gerenciar Auth users.\nexport function createAdminClient() {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\n  const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!\n\n  if (!serviceRoleKey) {\n    throw new Error('SUPABASE_SERVICE_ROLE_KEY não definida no .env.local')\n  }\n\n  return createClient(supabaseUrl, serviceRoleKey, {\n    auth: {\n      autoRefreshToken: false,\n      persistSession: false\n    }\n  })\n}\n"],"names":[],"mappings":";;;;AACA;;AAIO,SAAS;IACd,MAAM;IACN,MAAM,iBAAiB,QAAQ,GAAG,CAAC,yBAAyB;IAE5D,IAAI,CAAC,gBAAgB;QACnB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,IAAA,uNAAY,EAAC,aAAa,gBAAgB;QAC/C,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AACF"}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carolina/Desktop/00%20-%20Clubfit/components/student/student-header.tsx"],"sourcesContent":["import Image from 'next/image'\r\n\r\ninterface StudentHeaderProps {\r\n    logoUrl?: string | null\r\n    academyName: string\r\n    primaryColor: string\r\n}\r\n\r\nexport function StudentHeader({ logoUrl, academyName, primaryColor }: StudentHeaderProps) {\r\n    return (\r\n        <header className=\"bg-white shadow-sm sticky top-0 z-10 px-6 py-4 flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n                {logoUrl ? (\r\n                    <div className=\"relative h-10 w-10 overflow-hidden rounded-full border border-slate-100\">\r\n                        <Image\r\n                            src={logoUrl}\r\n                            alt={academyName}\r\n                            fill\r\n                            className=\"object-cover\"\r\n                        />\r\n                    </div>\r\n                ) : (\r\n                    <div\r\n                        className=\"h-10 w-10 flex items-center justify-center rounded-full text-white font-bold text-lg\"\r\n                        style={{ backgroundColor: primaryColor }}\r\n                    >\r\n                        {academyName.charAt(0).toUpperCase()}\r\n                    </div>\r\n                )}\r\n                <span className=\"font-bold text-slate-800 text-lg\">{academyName}</span>\r\n            </div>\r\n\r\n            <button className=\"text-slate-400\">\r\n                {/* Icone de Menu ou Perfil (Futuro) */}\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className=\"w-6 h-6\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5\" />\r\n                </svg>\r\n            </button>\r\n        </header>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;;AAQO,SAAS,cAAc,EAAE,OAAO,EAAE,WAAW,EAAE,YAAY,EAAsB;IACpF,qBACI,8QAAC;QAAO,WAAU;;0BACd,8QAAC;gBAAI,WAAU;;oBACV,wBACG,8QAAC;wBAAI,WAAU;kCACX,cAAA,8QAAC,wKAAK;4BACF,KAAK;4BACL,KAAK;4BACL,IAAI;4BACJ,WAAU;;;;;;;;;;6CAIlB,8QAAC;wBACG,WAAU;wBACV,OAAO;4BAAE,iBAAiB;wBAAa;kCAEtC,YAAY,MAAM,CAAC,GAAG,WAAW;;;;;;kCAG1C,8QAAC;wBAAK,WAAU;kCAAoC;;;;;;;;;;;;0BAGxD,8QAAC;gBAAO,WAAU;0BAEd,cAAA,8QAAC;oBAAI,OAAM;oBAA6B,MAAK;oBAAO,SAAQ;oBAAY,aAAa;oBAAK,QAAO;oBAAe,WAAU;8BACtH,cAAA,8QAAC;wBAAK,eAAc;wBAAQ,gBAAe;wBAAQ,GAAE;;;;;;;;;;;;;;;;;;;;;;AAKzE"}},
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carolina/Desktop/00%20-%20Clubfit/app/student/%28app%29/layout.tsx"],"sourcesContent":["import { getStudentSession } from '@/utils/auth-student'\r\nimport { createAdminClient } from '@/utils/supabase/admin'\r\nimport { redirect } from 'next/navigation'\r\nimport { StudentHeader } from '@/components/student/student-header'\r\n\r\nexport default async function StudentAppLayout({\r\n    children,\r\n}: {\r\n    children: React.ReactNode\r\n}) {\r\n    // 1. Validar Sessão\r\n    const session = await getStudentSession()\r\n    if (!session || !session.studentId) {\r\n        redirect('/student/login')\r\n    }\r\n\r\n    const { studentId, academyId } = session\r\n\r\n    // 2. Buscar Dados da Academia (Theme)\r\n    // Usamos admin client pois a tabela academies pode ter regras de leitura restritas\r\n    // e queremos garantir que pegamos os dados corretos vinculados ao token\r\n    const supabaseAdmin = createAdminClient()\r\n\r\n    const { data: academy } = await supabaseAdmin\r\n        .from('academies')\r\n        .select('name, logo_url, primary_color')\r\n        .eq('id', academyId)\r\n        .single()\r\n\r\n    const themeColor = academy?.primary_color || '#000000'\r\n\r\n    return (\r\n        <div\r\n            className=\"min-h-screen bg-slate-50 font-sans\"\r\n            style={\r\n                {\r\n                    '--primary-color': themeColor,\r\n                } as React.CSSProperties\r\n            }\r\n        >\r\n            <StudentHeader\r\n                academyName={academy?.name || 'ClubFit'}\r\n                logoUrl={academy?.logo_url}\r\n                primaryColor={themeColor}\r\n            />\r\n\r\n            <main className=\"pb-20\">\r\n                {children}\r\n            </main>\r\n\r\n            {/* TabBar de Navegação (Futuro) */}\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAAA;AACA;;;;;;AAEe,eAAe,iBAAiB,EAC3C,QAAQ,EAGX;IACG,oBAAoB;IACpB,MAAM,UAAU,MAAM,IAAA,6KAAiB;IACvC,IAAI,CAAC,WAAW,CAAC,QAAQ,SAAS,EAAE;QAChC,IAAA,iOAAQ,EAAC;IACb;IAEA,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG;IAEjC,sCAAsC;IACtC,mFAAmF;IACnF,wEAAwE;IACxE,MAAM,gBAAgB,IAAA,+KAAiB;IAEvC,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,cAC3B,IAAI,CAAC,aACL,MAAM,CAAC,iCACP,EAAE,CAAC,MAAM,WACT,MAAM;IAEX,MAAM,aAAa,SAAS,iBAAiB;IAE7C,qBACI,8QAAC;QACG,WAAU;QACV,OACI;YACI,mBAAmB;QACvB;;0BAGJ,8QAAC,4LAAa;gBACV,aAAa,SAAS,QAAQ;gBAC9B,SAAS,SAAS;gBAClB,cAAc;;;;;;0BAGlB,8QAAC;gBAAK,WAAU;0BACX;;;;;;;;;;;;AAMjB"}}]
}