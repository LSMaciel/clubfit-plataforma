exports.id=455,exports.ids=[455],exports.modules={17107:(a,b,c)=>{"use strict";c.d(b,{Z:()=>e});var d=c(93667);function e(){let a=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!a)throw Error("SUPABASE_SERVICE_ROLE_KEY n\xe3o definida no .env.local");return(0,d.UU)("https://huxwjxzuhrhrdyvzlgnx.supabase.co",a,{auth:{autoRefreshToken:!1,persistSession:!1}})}},20257:(a,b,c)=>{"use strict";c.d(b,{AdminContextSwitcher:()=>i});var d=c(48249),e=c(19099),f=c(99829);let g=(0,f.createServerReference)("40d991236331d005b136319e09ab1a79638575c248",f.callServer,void 0,f.findSourceMapURL,"switchAdminContext");var h=c(67484);function i({academies:a,currentContextId:b}){let c=(0,e.useRouter)(),[f,i]=(0,h.useTransition)(),[j,k]=(0,h.useState)(b||"");async function l(a){let b=""===a?null:a;k(a),i(async()=>{await g(b),c.refresh()})}return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-sm text-slate-500 hidden md:inline",children:"Contexto:"}),(0,d.jsxs)("select",{value:j,onChange:a=>l(a.target.value),disabled:f,className:`
                    text-sm border-slate-200 rounded-md py-1 pl-2 pr-8 cursor-pointer focus:ring-2 focus:ring-slate-900 focus:border-transparent
                    ${""===j?"bg-slate-100 text-slate-700 font-medium":"bg-amber-50 border-amber-200 text-amber-900 font-bold"}
                `,children:[(0,d.jsx)("option",{value:"",children:"\uD83C\uDF0E Vis\xe3o Global (Super Admin)"}),(0,d.jsx)("optgroup",{label:"Gerenciar Academia Espec\xedfica",children:a.map(a=>(0,d.jsxs)("option",{value:a.id,children:["\uD83C\uDFE2 ",a.name]},a.id))})]}),f&&(0,d.jsx)("span",{className:"text-xs text-slate-400 animate-pulse",children:"Carregando..."})]})}},20662:(a,b,c)=>{"use strict";c.d(b,{AdminContextSwitcher:()=>d});let d=(0,c(77943).registerClientReference)(function(){throw Error("Attempted to call AdminContextSwitcher() from the server but AdminContextSwitcher is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\carolina\\Desktop\\00 - Clubfit\\components\\admin\\admin-context-switcher.tsx","AdminContextSwitcher")},29457:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,95547,23))},32001:(a,b,c)=>{Promise.resolve().then(c.bind(c,20257)),Promise.resolve().then(c.t.bind(c,2116,23))},32056:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>i,metadata:()=>h,viewport:()=>g});var d=c(5735);c(82704);var e=c(2501),f=c.n(e);let g={themeColor:"#0f172a",width:"device-width",initialScale:1,maximumScale:1,userScalable:!1},h={title:"ClubFit",description:"Plataforma White-label de fidelidade e benef\xedcios."};function i({children:a}){return(0,d.jsx)("html",{lang:"pt-BR",children:(0,d.jsx)("body",{className:f().className,children:a})})}},34425:()=>{},36483:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,95547,23)),Promise.resolve().then(c.t.bind(c,15098,23)),Promise.resolve().then(c.t.bind(c,47644,23)),Promise.resolve().then(c.t.bind(c,33859,23)),Promise.resolve().then(c.t.bind(c,98099,23)),Promise.resolve().then(c.t.bind(c,16237,23)),Promise.resolve().then(c.t.bind(c,98562,23)),Promise.resolve().then(c.t.bind(c,36675,23))},50555:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81921,23)),Promise.resolve().then(c.t.bind(c,60440,23)),Promise.resolve().then(c.t.bind(c,84342,23)),Promise.resolve().then(c.t.bind(c,82265,23)),Promise.resolve().then(c.t.bind(c,35421,23)),Promise.resolve().then(c.t.bind(c,61335,23)),Promise.resolve().then(c.t.bind(c,70664,23)),Promise.resolve().then(c.bind(c,74661))},62112:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>l});var d=c(5735),e=c(63059),f=c.n(e),g=c(69754),h=c(82604),i=c(65573),j=c(20662);async function k(){let a=await (0,g.U)(),{data:{user:b}}=await a.auth.getUser(),{data:c}=await a.from("users").select("*").eq("id",b?.id).single(),e=c?.role==="SUPER_ADMIN",k=[],l=null;if(e){let{data:b}=await a.from("academies").select("id, name").order("name");k=b||[];let c=await (0,i.UL)();l=c.get("admin-context-academy-id")?.value||null}let m="ClubFit Admin",n="text-slate-900";if(l){let a=k.find(a=>a.id===l);a&&(m=`${a.name} (Modo Admin)`,n="text-amber-700")}return(0,d.jsxs)("nav",{className:"bg-white border-b border-slate-200 px-8 py-4 flex justify-between items-center sticky top-0 z-50",children:[(0,d.jsxs)("div",{className:"flex items-center gap-6",children:[(0,d.jsx)(f(),{href:"/admin/dashboard",className:`font-bold text-xl ${n}`,children:m}),e&&(0,d.jsx)("div",{className:"pl-6 border-l border-slate-200",children:(0,d.jsx)(j.AdminContextSwitcher,{academies:k,currentContextId:l})})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsxs)("div",{className:"text-sm text-right hidden sm:block",children:[(0,d.jsx)("p",{className:"font-medium",children:c?.name||b?.email}),(0,d.jsx)("p",{className:"text-xs text-slate-500 uppercase",children:c?.role?.replace("_"," ")})]}),(0,d.jsx)("form",{action:h.C,children:(0,d.jsx)("button",{className:"text-sm text-red-600 hover:text-red-800 font-medium px-3 py-1 border border-transparent hover:border-red-100 rounded-md transition-colors",children:"Sair"})})]})]})}function l({children:a}){return(0,d.jsxs)("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[(0,d.jsx)(k,{}),(0,d.jsx)("div",{className:"flex-1 w-full",children:a})]})}},67527:(a,b,c)=>{"use strict";c.d(b,{U:()=>f});var d=c(37160),e=c(36042);async function f(){let a=await (0,e.UL)();return(0,d.createServerClient)("https://huxwjxzuhrhrdyvzlgnx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1eHdqeHp1aHJocmR5dnpsZ254Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MjU0NzQsImV4cCI6MjA3NDQwMTQ3NH0.zyMrpeFv-4Js3E2_ml538_IffkyBAyornWaLpa0-lSc",{cookies:{get:b=>a.get(b)?.value,set(b,c,d){try{a.set({name:b,value:c,...d})}catch(a){}},remove(b,c){try{a.set({name:b,value:"",...c})}catch(a){}}}})}},69754:(a,b,c)=>{"use strict";c.d(b,{U:()=>f});var d=c(74968),e=c(65573);async function f(){let a=await (0,e.UL)();return(0,d.createServerClient)("https://huxwjxzuhrhrdyvzlgnx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh1eHdqeHp1aHJocmR5dnpsZ254Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MjU0NzQsImV4cCI6MjA3NDQwMTQ3NH0.zyMrpeFv-4Js3E2_ml538_IffkyBAyornWaLpa0-lSc",{cookies:{get:b=>a.get(b)?.value,set(b,c,d){try{a.set({name:b,value:c,...d})}catch(a){}},remove(b,c){try{a.set({name:b,value:"",...c})}catch(a){}}}})}},78335:()=>{},81563:(a,b,c)=>{"use strict";c.d(b,{B:()=>k,H:()=>j});var d=c(95349);c(22817);var e=c(67527),f=c(49487),g=c(42650),h=c(17107),i=c(36042);async function j(a,b){let c=await (0,e.U)(),d=(0,h.Z)(),{data:{user:i}}=await c.auth.getUser();if(!i)return{error:"N\xe3o autenticado."};let{data:j}=await d.from("users").select("role").eq("id",i.id).single();if(j?.role!=="SUPER_ADMIN")return{error:"Permiss\xe3o negada."};let k=b.get("name"),l=b.get("slug"),m=b.get("primary_color"),n=b.get("logo"),o=b.get("owner_name"),p=b.get("owner_email"),q=b.get("owner_password"),r=b.get("zip_code"),s=b.get("street"),t=b.get("number"),u=b.get("neighborhood"),v=b.get("city"),w=b.get("state"),x=b.get("complement"),y=b.get("latitude"),z=b.get("longitude"),A=y?parseFloat(y):null,B=z?parseFloat(z):null;if(!k||!l)return{error:"Nome e Slug s\xe3o obrigat\xf3rios."};if(!/^[a-z0-9-]+$/.test(l))return{error:"O Slug deve conter apenas letras min\xfasculas, n\xfameros e h\xedfens."};let C=p||q||o;if(C&&(!p||!q||!o))return{error:"Para criar um usu\xe1rio, preencha Nome, Email e Senha."};let D=null;if(n&&n.size>0){let a=n.name.split(".").pop(),b=`${l}-${Date.now()}.${a}`,c=`public/${b}`,{error:e}=await d.storage.from("academy-logos").upload(c,n,{contentType:n.type,upsert:!0});if(e)return console.error("Erro upload:",e),{error:`Erro ao fazer upload da logo: ${e.message}`};let{data:{publicUrl:f}}=d.storage.from("academy-logos").getPublicUrl(c);D=f}let E=null;if(C){let{data:a,error:b}=await d.auth.admin.createUser({email:p,password:q,email_confirm:!0,user_metadata:{full_name:o}});if(b)return{error:`Erro ao criar login: ${b.message}`};E=a.user.id}let{data:F,error:G}=await d.from("academies").insert({name:k,slug:l,primary_color:m||"#000000",logo_url:D,zip_code:r||null,street:s||null,number:t||null,neighborhood:u||null,city:v||null,state:w||null,complement:x||null,latitude:A,longitude:B}).select().single();if(G)return(E&&await d.auth.admin.deleteUser(E),"23505"===G.code)?{error:"Este Slug j\xe1 est\xe1 em uso. Escolha outro."}:(console.error("Erro insert academy:",G),{error:"Erro ao cadastrar academia."});if(E){let{error:a}=await d.from("users").insert({id:E,name:o,role:"ACADEMY_ADMIN",academy_id:F.id});if(a)return await d.from("academies").delete().eq("id",F.id),await d.auth.admin.deleteUser(E),console.error("Erro insert user profile:",a),{error:"Erro ao criar perfil do administrador."}}(0,g.revalidatePath)("/admin/academies"),(0,f.redirect)("/admin/academies")}async function k(a){let b=await (0,e.U)(),{data:{user:c}}=await b.auth.getUser();if(!c)return{error:"Not authenticated"};let{data:d}=await b.from("users").select("role").eq("id",c.id).single();if(d?.role!=="SUPER_ADMIN")return{error:"Unauthorized: Only Super Admin can switch context."};let f=await (0,i.UL)();return a?f.set("admin-context-academy-id",a):f.delete("admin-context-academy-id"),(0,g.revalidatePath)("/admin","layout"),{success:!0}}(0,c(89337).D)([j,k]),(0,d.A)(j,"6007f95e730dcbcf30d7a183a5b627bcf8e81ae513",null),(0,d.A)(k,"40d991236331d005b136319e09ab1a79638575c248",null)},82604:(a,b,c)=>{"use strict";c.d(b,{C:()=>h,J:()=>g});var d=c(49796);c(11472);var e=c(69754),f=c(91970);async function g(a){let b=a.get("email"),c=a.get("password"),d=await (0,e.U)(),{error:g}=await d.auth.signInWithPassword({email:b,password:c});if(g)return(0,f.redirect)("/admin/login?message=Credenciais inv\xe1lidas.");let{data:h,error:i}=await d.from("users").select("role").single();return i||!h?(await d.auth.signOut(),(0,f.redirect)("/admin/login?message=Erro ao verificar cadastro.")):"STUDENT"===h.role?(await d.auth.signOut(),(0,f.redirect)("/admin/login?message=Acesso restrito a administradores.")):(0,f.redirect)("/admin/dashboard")}async function h(){let a=await (0,e.U)();return await a.auth.signOut(),(0,f.redirect)("/admin/login")}(0,c(24424).D)([g,h]),(0,d.A)(g,"408871e42ee1e24a5bededb0e94fa2c63259926805",null),(0,d.A)(h,"00ac88b1bc69c960b32096949e9a5ddd92273698d9",null)},82704:()=>{},94609:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81921,23))},95553:(a,b,c)=>{Promise.resolve().then(c.bind(c,20662)),Promise.resolve().then(c.t.bind(c,23318,23))},96487:()=>{},97977:()=>{}};